{
  "name": "Caliby Vector Search Library",
  "path": "/home/zxjcarrot/Workspace/caliby",
  "language": "c++",
  "description": "Project: Caliby Vector Search Library\nLocation: /home/zxjcarrot/Workspace/caliby\nLanguage: C++\n\nHow to build:\nThis is a C++/python project. You should always use rebuild.sh to build everything from scratch and install the caliby python  package in the system.\n\n\nHow to benchmark:\n\nrun python3 ./benchmark/compare_hnsw.py --skip usearch,faiss\nwhich outputs the something like the following\n\n=========================================================================================================\n\nzxjcarrot@zxjcarrot-MS-7E07:~/Workspace/caliby$ python3 ./benchmark/compare_hnsw.py --skip usearch,faiss\nCaliby version: 0.1.0.dev20251222.180901\n====================================================================================================\nHNSW BENCHMARK: Caliby vs Usearch vs Faiss\n====================================================================================================\n\nDataset: SIFT1M (1M vectors, 128 dimensions)\nParameters: M=16, ef_construction=100, ef_search=50\n\nLibraries enabled:\n  caliby     \u2713 Enabled\n  usearch    \u2717 Disabled\n  faiss      \u2717 Disabled\n\u2713 SIFT1M dataset already exists in ./sift1m\n\nLoading SIFT1M dataset...\n  Base vectors: (1000000, 128)\n  Query vectors: (10000, 128)\n  Ground truth: (10000, 100)\n\n======================================================================\nBenchmarking Caliby HNSW\n======================================================================\n\nBuilding index with 1000000 vectors (dim=128)...\n  M=16, ef_construction=100\n[IndexTranslationArray] Created for index 0 with capacity=6291456 pages (12288 ref count groups)\n[TwoLevelPageStateArray] Created multi-index translation array with 65536 index slots, default index capacity=6291456\n[IndexCatalog] Loaded 1 entries from ./catalog.dat\ncalico BufferManager initialized: blk:./heapfile virtgb:24 physgb:3 traditional:1 mmap_os_pagecache:0 trad_hash:5 exmap:0 hugepage: 1 hugepage for translation array: 0 num_threads:1 translation_specialization:calico\nHNSW Initialization: Dim=128, M=16, M0=32, efConstruction=100, MaxLevel=6, FixedNodeSize=972 bytes, NodesPerPage=4, enable_prefetch=1\n[IndexTranslationArray] Created for index 1 with capacity=277049 pages (542 ref count groups)\n[TwoLevelPageStateArray] Registered index 1 with capacity 277049\n[BufferManager] Registered index 1 in TwoLevelPageStateArray with max_pages=277049 initial_alloc=1\n[BufferManager] Created allocator for index 1 starting at 1\n[HNSW Recovery] skip_recovery=false has_existing_meta=false\n[HNSW Recovery] params_match=false\n[HNSW Recovery] can_reuse_storage=false\n[HNSW Recovery] Allocated new metadata page 4294967297 base_pid=4294967298 total_pages=250000\n[HNSW Recovery] Metadata page updated and marked valid\n  Adding 1000000 vectors...\n\u2713 Build time: 21.55s\nBufferManager flushed 0 pages.\n\u2713 Estimated index size: 488.28 MB\n\nWarming up...\nRunning search benchmark (ef_search=50)...\n  Processed 10000/10000 queries\n\n====================================================================================================\nBENCHMARK RESULTS SUMMARY\n====================================================================================================\n\nLibrary         Build(s)     Size(MB)     QPS          P50(ms)    P95(ms)    P99(ms)    Recall@10   \n----------------------------------------------------------------------------------------------------\nCaliby          21.55        488.28       9933.4       0.102      0.135      0.155      0.8977      \n\n====================================================================================================\n\nWINNERS:\n  \ud83c\udfc6 Highest QPS:        Caliby (9933.4 queries/sec)\n  \ud83c\udfc6 Best Recall@10:     Caliby (0.8977)\n  \ud83c\udfc6 Lowest P50 Latency: Caliby (0.102 ms)\n  \ud83c\udfc6 Smallest Index:     Caliby (488.28 MB)\n  \ud83c\udfc6 Fastest Build:      Caliby (21.55 s)\n\n====================================================================================================\nCalico module unloading: Shutting down system...\nBufferManager flushed 0 pages.\n[BufferManager] Total hole punches (madvise count): 0\n[IndexCatalog] Persisted 1 entries to ./catalog.dat\n=========================================================================================================\n\n\n\nWhat to optimize:\nYou should optimize the QPS metric in the above output.\n\n\nHow to profile:\nYou may use perf to collect stats when the benchmark is started after 10 seconds and profile for at most 3 seconds.\nFor example: sudo perf record -g -p 993187 sleep 3\n\nYou can assume perf is installed and FlameGraph tool is also available at /home/zxjcarrot/Workspace/FlameGraph\n\nPlease use `sudo perf report --stdio -n  folded` to output text-based hotspot for easier analysis for LLM. You should feed the top-100 lines of the perf report output.\n\nIn addition to using perf record, you can also use `perf stat -p <pid> sleep 3` to collect microarch metrics for the program to help guide you guide the optimization. Please use perf stat after perf record phase has been finished. Please upload both perf-record/perf-report results and perf-stat results to LLM\n\n\nHow to test:\n\nrun bash ./run_tests.sh\n\n\nThe above command will produce something that contains the following :\n....\n======================================================================================== short test summary info =========================================================================================\nFAILED ../../home/zxjcarrot/Workspace/caliby/tests/test_multi_index_direct.py::TestMultiIndexIsolation::test_no_cross_contamination_varying_dims\nFAILED ../../home/zxjcarrot/Workspace/caliby/tests/test_multi_index_direct.py::TestMultiIndexIsolation::test_interleaved_operations\n===================================================================================== 2 failed, 143 passed in 23.67s =====================================================================================\n...\n\n\n\nYou are only allow to have up to 5 failing tests.\n\n\nOptimization Hints\n\nsearchLayer function in src/hnsw.cpp:433 is the hottest function. \nPlease consider how to improve it as a starting point.",
  "build_description": "This is a C++/python project. You should always use rebuild.sh to build everything from scratch and install the caliby python  package in the system.",
  "benchmark_description": "run python3 ./benchmark/compare_hnsw.py --skip usearch,faiss\nwhich outputs the something like the following\n=========================================================================================================\nzxjcarrot@zxjcarrot-MS-7E07:~/Workspace/caliby$ python3 ./benchmark/compare_hnsw.py --skip usearch,faiss\nCaliby version: 0.1.0.dev20251222.180901\n====================================================================================================\nHNSW BENCHMARK: Caliby vs Usearch vs Faiss\n====================================================================================================\nDataset: SIFT1M (1M vectors, 128 dimensions)\nParameters: M=16, ef_construction=100, ef_search=50\nLibraries enabled:\ncaliby     \u2713 Enabled\nusearch    \u2717 Disabled\nfaiss      \u2717 Disabled\n\u2713 SIFT1M dataset already exists in ./sift1m\nLoading SIFT1M dataset...\nBase vectors: (1000000, 128)\nQuery vectors: (10000, 128)\nGround truth: (10000, 100)\n======================================================================\nBenchmarking Caliby HNSW\n======================================================================\nBuilding index with 1000000 vectors (dim=128)...\nM=16, ef_construction=100\n[IndexTranslationArray] Created for index 0 with capacity=6291456 pages (12288 ref count groups)\n[TwoLevelPageStateArray] Created multi-index translation array with 65536 index slots, default index capacity=6291456\n[IndexCatalog] Loaded 1 entries from ./catalog.dat\ncalico BufferManager initialized: blk:./heapfile virtgb:24 physgb:3 traditional:1 mmap_os_pagecache:0 trad_hash:5 exmap:0 hugepage: 1 hugepage for translation array: 0 num_threads:1 translation_specialization:calico\nHNSW Initialization: Dim=128, M=16, M0=32, efConstruction=100, MaxLevel=6, FixedNodeSize=972 bytes, NodesPerPage=4, enable_prefetch=1\n[IndexTranslationArray] Created for index 1 with capacity=277049 pages (542 ref count groups)\n[TwoLevelPageStateArray] Registered index 1 with capacity 277049\n[BufferManager] Registered index 1 in TwoLevelPageStateArray with max_pages=277049 initial_alloc=1\n[BufferManager] Created allocator for index 1 starting at 1\n[HNSW Recovery] skip_recovery=false has_existing_meta=false\n[HNSW Recovery] params_match=false\n[HNSW Recovery] can_reuse_storage=false\n[HNSW Recovery] Allocated new metadata page 4294967297 base_pid=4294967298 total_pages=250000\n[HNSW Recovery] Metadata page updated and marked valid\nAdding 1000000 vectors...\n\u2713 Build time: 21.55s\nBufferManager flushed 0 pages.\n\u2713 Estimated index size: 488.28 MB\nWarming up...\nRunning search benchmark (ef_search=50)...\nProcessed 10000/10000 queries\n====================================================================================================\nBENCHMARK RESULTS SUMMARY\n====================================================================================================\nLibrary         Build(s)     Size(MB)     QPS          P50(ms)    P95(ms)    P99(ms)    Recall@10\n----------------------------------------------------------------------------------------------------\nCaliby          21.55        488.28       9933.4       0.102      0.135      0.155      0.8977\n====================================================================================================\nWINNERS:\n\ud83c\udfc6 Highest QPS:        Caliby (9933.4 queries/sec)\n\ud83c\udfc6 Best Recall@10:     Caliby (0.8977)\n\ud83c\udfc6 Lowest P50 Latency: Caliby (0.102 ms)\n\ud83c\udfc6 Smallest Index:     Caliby (488.28 MB)\n\ud83c\udfc6 Fastest Build:      Caliby (21.55 s)\n====================================================================================================\nCalico module unloading: Shutting down system...\nBufferManager flushed 0 pages.\n[BufferManager] Total hole punches (madvise count): 0\n[IndexCatalog] Persisted 1 entries to ./catalog.dat\n=========================================================================================================",
  "profiling_description": "You may use perf to collect stats when the benchmark is started after 10 seconds and profile for at most 3 seconds.\nFor example: sudo perf record -g -p 993187 sleep 3\nYou can assume perf is installed and FlameGraph tool is also available at /home/zxjcarrot/Workspace/FlameGraph\nPlease use `sudo perf report --stdio -n  folded` to output text-based hotspot for easier analysis for LLM. You should feed the top-100 lines of the perf report output.\nIn addition to using perf record, you can also use `perf stat -p <pid> sleep 3` to collect microarch metrics for the program to help guide you guide the optimization. Please use perf stat after perf record phase has been finished. Please upload both perf-record/perf-report results and perf-stat results to LLM",
  "optimization_goals": [
    "You should optimize the QPS metric in the above output."
  ],
  "constraints": [],
  "test_description": "run bash ./run_tests.sh\nThe above command will produce something that contains the following :\n....\n======================================================================================== short test summary info =========================================================================================\nFAILED ../../home/zxjcarrot/Workspace/caliby/tests/test_multi_index_direct.py::TestMultiIndexIsolation::test_no_cross_contamination_varying_dims\nFAILED ../../home/zxjcarrot/Workspace/caliby/tests/test_multi_index_direct.py::TestMultiIndexIsolation::test_interleaved_operations\n===================================================================================== 2 failed, 143 passed in 23.67s =====================================================================================\n...\nYou are only allow to have up to 5 failing tests.\nOptimization Hints\nsearchLayer function in src/hnsw.cpp:433 is the hottest function.\nPlease consider how to improve it as a starting point.",
  "optimization_hints": [],
  "max_iterations": 20
}